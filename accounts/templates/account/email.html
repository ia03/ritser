{% extends "account/base.html" %}

{% load static %}

{% block title %}Account - MoDebate{% endblock %}

{% block body %}
<main role="main" class="container">
    <h1>E-mail Addresses</h1>
{% if user.emailaddress_set.all %}
<p>The following e-mail addresses are associated with your account:</p>

<form action="{% url 'account_email' %}" class="email_list" method="post">
{% csrf_token %}
<fieldset class="blockLabels">

  {% for emailaddress in user.emailaddress_set.all %}
<div class="ctrlHolder radio">
      <label for="email_radio_{{forloop.counter}}" class="{% if emailaddress.primary %}primary_email{%endif%}">

      <input id="email_radio_{{forloop.counter}}" type="radio" name="email" {% if emailaddress.primary or user.emailaddress_set.count == 1 %}checked="checked"{%endif %} value="{{emailaddress.email}}"/>

{{ emailaddress.email }}
    {% if emailaddress.verified %}
    <span class="verified">Verified</span>
    {% else %}
    <span class="unverified">Unverified</span>
    {% endif %}
      {% if emailaddress.primary %}<span class="primary">Primary</span>{% endif %}
</label>
</div>
  {% endfor %}

<div class="buttonHolder">
      <button class="secondaryAction btn btn-outline-primary" type="submit" name="action_primary" >Make Primary</button>
      <button class="secondaryAction btn btn-outline-primary" type="submit" name="action_send" >Re-send Verification</button>
      <button class="primaryAction btn btn-outline-primary" type="submit" name="action_remove" >Remove</button>
</div>

</fieldset>
</form>

{% else %}
<p><strong>Warning:</strong> You currently do not have any e-mail addresses set up.</p>

{% endif %}


    <h2>Add E-mail Address</h2>

    <form method="post" action="{% url 'account_email' %}" class="add_email">
        {% csrf_token %}
        <label for="id_email">E-mail:</label>
        <input class="form-control" type="email" name="email" size="30" placeholder="E-mail address" required id="id_email" /></p>
        <div class="form-group">
            <label for="id_captcha"><label for="id_captcha">Captcha:</label></label>
            <script src="https://www.google.com/recaptcha/api.js?hl=en"></script>
            <div class="g-recaptcha" data-sitekey="6Lc71U4UAAAAALLVIW91zfM37xT_8DSYvCdyXA7M" data-class="form-control" data-required="True" data-id="id_captcha" ></div>
            <noscript>
              <div style="width: 302px; height: 352px;">
                <div style="width: 302px; height: 352px; position: relative;">
                  <div style="width: 302px; height: 352px; position: absolute;">
                    <iframe src="https://www.google.com/recaptcha/api/fallback?k=6Lc71U4UAAAAALLVIW91zfM37xT_8DSYvCdyXA7M"
                            frameborder="0" scrolling="no"
                            style="width: 302px; height:352px; border-style: none;">
                    </iframe>
                  </div>
                  <div style="width: 250px; height: 80px; position: absolute; border-style: none;
                              bottom: 21px; left: 25px; margin: 0px; padding: 0px; right: 25px;">
                    <textarea id="g-recaptcha-response" name="g-recaptcha-response"
                              class="recaptcha_challenge_field"
                              style="width: 250px; height: 80px; border: 1px solid #c1c1c1;
                                     margin: 0px; padding: 0px; resize: none;" value="">
                    </textarea>
                    <input type="hidden" name="recaptcha_response_field" value="manual_challenge" />
                  </div>
                </div>
              </div>
            </noscript>
        </div>
        <button class="btn btn-outline-primary" name="action_add" type="submit">Add E-mail</button>
    </form>
</main>
{% endblock %}


{% block endjs %}
<script src="{% static 'account/js/email.js' %}"></script>
{% endblock %}